# 섹션 08. HTTP 헤더(2) - 캐시와 조건부 요청
## 01. 캐시 기본 동작
### 캐시가 없을 때
- 데이터가 변경되지 않아도 계속해서 네트워크를 통해 데이터를 다운로드 받아야함
- 인터넷 네트워크는 느리고 비쌈 -> 브라우저의 느린 로딩 속도 -> `느림`에 대한 사용자 경험  
<br/>

### 캐시가 있을 때
- `캐시` 덕분에 캐시 유지 시간 동안 네트워크를 통한 데이터 다운로드를 하지 않아도 됨
- 비싼 네트워크 사용량을 줄일 수 있음 -> 브라우저 로딩 속도가 빨라짐 -> `빠름`에 대한 사용자 경험
- 만약 캐시 유효 시간이 초과되면, 서버를 통해 데이터를 다시 조회하고 캐시를 갱신해야 함
	- 새로운 캐시 갱신 시 다시 네트워크 다운로드가 발생함  
<br/><br/><br/>

## 02. 검증 헤더와 조건부 요청 (1)
### 캐시 시간 초과
캐시 유효 시간 초과시 서버에 재요청을 하면 아래의 두 가지 상황이 나타날 수 있음
1. 서버에서 기존 데이터를 변경함 -> 같은 데이터를 요청했으나 이전과 다른 데이터를 응답 받음
2. 서버에서 기존 데이터를 변경하지 않음 -> 같은 데이터를 요청하면 이전과 같은 데이터를 응답 받음
	- 해당 경우 새로운 데이터를 받는 대신 저장해 두었던 `캐시를 재사용하는게` 더 편함
	- 그렇다면 캐시에 저장되어있는 데이터와 서버에 저장되어 있는 데이터가 같다는 `증명(사실 확인)`이 필요함!  
<br/>

### 검증 헤더와 조건부 요청
1. 서버는 `검증 헤더`로 첫 요청 응답시 헤더에 `데이터의 최종 수정일`을 적어 전송함
2. 클라이언트는 해당 응답을 캐시로 가지고 있다가 유효기간이 만료되고 서버에 재요청
	- 여기서 클라이언트는 `조건부 요청`으로 캐시에 저장되어있는 `데이터의 최종 수정일`을 요청에 포함시킴
3. 서버는 `조건부 요청`의 정보와 현재 요청받은 데이터의 최종 수정일을 비교함
4. 만약 데이터의 수정이 이루어지지 않았다면 `304 Not Modified` 응답과 함께 아래의 정보를 포함해 응답함
	- 캐시의 새로운 갱신 값(유효 기간), 검증 헤더 정보
	- 이 때 응답에는 `HTTP Body`가 없음
5. 클라이언트는 응답 결과를 통해 캐시를 갱신하여 캐시를 통해 데이터를 조회함  
<br/>

#### 정리
- 캐시 유효 시간이 초과해도, 서버의 데이터가 갱신되지 않으면
	- 304 Not Modified + 헤더 메타 정보만 응답(바디X)
- 클라이언트는 서버가 보낸 응답 헤더 정보로 캐시의 메타 정보를 갱신
	- 클라이언트는 캐시에 저장되어 있는 데이터 재활용 가능
- 결과적으로 네트워크 다운로드가 발생하지만 용량이 적은 `헤더 정보만 다운로드`
	- 매우 실용적인 해결책